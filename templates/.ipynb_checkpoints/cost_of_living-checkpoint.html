{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">

    <!-- Cost of Living Budget Calculation Section -->
    <div class="card shadow-sm p-4 mb-5 rounded">
        <h2 class="text-center text-success mb-4">üí∞ Cost of Living Support</h2>
        <p class="text-center text-muted mb-5">Estimate your monthly living costs based on your inputs:</p>

        <form method="POST" action="{{ url_for('cost_of_living') }}" class="space-y-4">
            <div class="mb-3">
                <label for="rent" class="form-label">Rent (per month):</label>
                <input type="number" id="rent" name="rent" class="form-control" min="0" required>
            </div>
            <div class="mb-3">
                <label for="groceries" class="form-label">Groceries (per month):</label>
                <input type="number" id="groceries" name="groceries" class="form-control" min="0" required>
            </div>
            <div class="mb-3">
                <label for="transportation" class="form-label">Transportation (per month):</label>
                <input type="number" id="transportation" name="transportation" class="form-control" min="0" required>
            </div>
            <div class="mb-3">
                <label for="entertainment" class="form-label">Entertainment (per month):</label>
                <input type="number" id="entertainment" name="entertainment" class="form-control" min="0" required>
            </div>

            <button type="submit" class="btn btn-warning w-100 py-3 fw-bold">Calculate Total Budget</button>
        </form>

        {% if total_budget %}
        <div class="alert alert-warning mt-4">
            <h4 class="fw-bold">Estimated Total Budget:</h4>
            <p class="fs-4">${{ total_budget }}</p>
        </div>
        {% endif %}
    </div>

    <!-- Browse Budget Resources Section -->
    <div class="card shadow-sm p-4 mb-5 rounded">
        <h3 class="text-center text-info mb-4">üìÇ Browse Budget Resources</h3>
        <form method="POST" action="{{ url_for('upload_resource') }}" enctype="multipart/form-data" class="mb-4">
            <div class="mb-3">
                <label class="form-label">Upload Resource (Image, Video, or Text):</label>
                <input type="file" name="resource_file" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-success">Upload Resource</button>
        </form>

        <!-- Display uploaded resources (images, text files) -->
        <h4 class="text-muted">Uploaded Resources:</h4>
        {% if resources %}
            <ul class="list-group">
                {% for resource in resources %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <a href="{{ url_for('download_resource', filename=resource) }}" class="btn btn-info btn-sm">Download {{ resource }}</a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No resources uploaded yet.</p>
        {% endif %}
    </div>

    <!-- Dormitory Search Section -->
    <div class="card shadow-sm p-4 mb-5 rounded">
        <h3 class="text-center text-primary mb-4">üè† Dormitory Information</h3>
        <form method="GET" action="{{ url_for('search_dormitory') }}">
            <div class="input-group mb-3">
                <input type="text" class="form-control" name="search" placeholder="Search for dormitory details (e.g., price, environment)" required>
                <button class="btn btn-primary" type="submit">Search</button>
            </div>
        </form>

        {% if dormitories %}
        <div class="list-group">
            {% for dorm in dormitories %}
                <div class="list-group-item">
                    <h5>{{ dorm.name }}</h5>
                    <p>Price: ${{ dorm.price }}</p>
                    <p>{{ dorm.environment }}</p>
                    <a href="{{ dorm.details_link }}" class="btn btn-info btn-sm">View Details</a>
                </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No dormitories found.</p>
        {% endif %}
    </div>

    <!-- Economic Aid & Campus Jobs Section -->
    <div class="card shadow-sm p-4 mb-5 rounded">
        <h3 class="text-center text-warning mb-4">üíº Economic Aid & Campus Jobs</h3>
        <form method="GET" action="{{ url_for('search_jobs') }}">
            <div class="input-group mb-3">
                <input type="text" class="form-control" name="search" placeholder="Search for economic aid or campus jobs" required>
                <button class="btn btn-warning" type="submit">Search</button>
            </div>
        </form>

        {% if jobs %}
        <div class="list-group">
            {% for job in jobs %}
                <div class="list-group-item">
                    <h5>{{ job.title }}</h5>
                    <p>{{ job.description }}</p>
                    <a href="{{ job.details_link }}" class="btn btn-info btn-sm">View Details</a>
                </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No job or aid information found.</p>
        {% endif %}
    </div>

</div>
{% endblock %}
